<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap
PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="Channel">
	<resultMap class="com.webreach.mirth.model.Channel" id="get-channel-result">
		<result property="id" column="ID" />
		<result property="name" column="NAME" />
		<result property="description" column="DESCRIPTION" />
		<result property="enabled" column="IS_ENABLED" />
		<result property="version" column="VERSION" />
		<result property="revision" column="REVISION" />		
		<result property="direction" column="DIRECTION" />								
		<result property="protocol" column="PROTOCOL" />
		<result property="mode" column="MODE" />
		<result property="sourceConnector" column="SOURCE_CONNECTOR" />
		<result property="destinationConnectors" column="DESTINATION_CONNECTORS" />
		<result property="properties" column="PROPERTIES" />
		<result property="preprocessingScript" column="PREPROCESSING_SCRIPT" />
	</resultMap>
	
	<select id="getChannel" parameterClass="com.webreach.mirth.model.Channel" resultMap="get-channel-result">
		SELECT *
		FROM CHANNEL
		<dynamic prepend="WHERE">
			<isNotNull prepend="AND" property="id">
				ID=#id#
			</isNotNull>
			<isNotNull prepend="AND" property="name">
				NAME=#name#
			</isNotNull>
		</dynamic>
	</select>
	
	<select id="getChannelRevision" resultClass="java.lang.Integer">
		SELECT
			ID as id,
			REVISION as revision
		FROM CHANNEL
	</select>
	
	<insert id="insertChannel" parameterClass="com.webreach.mirth.model.Channel">
		INSERT INTO
		CHANNEL (ID, NAME, DESCRIPTION, IS_ENABLED, VERSION, REVISION, DIRECTION, PROTOCOL, MODE, SOURCE_CONNECTOR, DESTINATION_CONNECTORS, PROPERTIES, PREPROCESSING_SCRIPT)
		VALUES (#id#, #name#, #description#, #enabled#, #version#, #revision#, #direction#, #protocol#, #mode#, #sourceConnector#, #destinationConnectors#, #properties#, #preprocessingScript#)
	</insert>
	
	<update id="updateChannel" parameterClass="com.webreach.mirth.model.Channel">
		UPDATE CHANNEL
		SET NAME = #name#,
			DESCRIPTION = #description#,
			IS_ENABLED = #enabled#,
			VERSION = #version#,
			REVISION = #revision#,
			DIRECTION = #direction#,
			PROTOCOL = #protocol#,
			MODE = #mode#,
			SOURCE_CONNECTOR = #sourceConnector#,
			DESTINATION_CONNECTORS = #destinationConnectors#,
			PROPERTIES = #properties#,
			PREPROCESSING_SCRIPT = #preprocessingScript#
		WHERE ID = #id#
	</update>
	
	<delete id="deleteChannel" parameterClass="com.webreach.mirth.model.Channel">
		DELETE FROM CHANNEL
		<dynamic prepend="WHERE">
			<isNotNull prepend="AND" property="id">
				ID=#id#
			</isNotNull>
		</dynamic>
	</delete>
</sqlMap>