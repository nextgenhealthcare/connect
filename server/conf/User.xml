<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap
PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="User">
	<parameterMap class="com.webreach.mirth.model.User" id="insert-user-param">
		<parameter property="username" />
		<parameter property="password" />
		<parameter property="email" jdbcType="VARCHAR" />
	</parameterMap>

	<parameterMap class="com.webreach.mirth.model.User" id="update-user-param">
		<parameter property="username" />
		<parameter property="password" />
		<parameter property="email" jdbcType="VARCHAR" />
		<parameter property="id" />
	</parameterMap>

	<resultMap class="com.webreach.mirth.model.User" id="get-user-result">
		<result property="id" column="ID" />
		<result property="username" column="USERNAME" />
		<result property="password" column="PASSWORD" />
		<result property="email" column="EMAIL" />
	</resultMap>
	
	<select id="getUser" parameterClass="com.webreach.mirth.model.User" resultMap="get-user-result">
		SELECT *
		FROM PERSON
		<dynamic prepend="WHERE">
			<isNotNull prepend="AND" property="id">
				ID=#id#
			</isNotNull>
			<isNotNull prepend="AND" property="username">
				USERNAME=#username#
			</isNotNull>
			<isNotNull prepend="AND" property="password">
				PASSWORD=#password#
			</isNotNull>
		</dynamic>
	</select>
	
	<insert id="insertUser" parameterMap="insert-user-param">
		INSERT INTO
		PERSON (USERNAME, PASSWORD, EMAIL)
		VALUES (?, ?, ?)
	</insert>
	
	<update id="updateUser" parameterMap="update-user-param">
		UPDATE PERSON
		SET USERNAME = ?,
			PASSWORD = ?,
			EMAIL = ?
		WHERE ID = ?
	</update>
	
	<delete id="deleteUser" parameterClass="com.webreach.mirth.model.User">
		DELETE FROM PERSON
		<dynamic prepend="WHERE">
			<isNotNull prepend="AND" property="id">
				ID=#id#
			</isNotNull>
		</dynamic>
	</delete>
</sqlMap>